version: '3.8'

services:
  react-app:
    # üü¢ ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ Docker ‡πÉ‡∏ä‡πâ Dockerfile ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
    build:
      context: .
      dockerfile: Dockerfile
    container_name: react-frontend
    
    # Map Port 8080 (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏£‡∏≤) ‡πÑ‡∏õ 8080 (‡πÉ‡∏ô Container)
    ports:
      - "8080:8080"
      
    # üü¢ Volumes: ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Hot Reloading
    volumes:
      # 1. Sync ‡πÇ‡∏Ñ‡πâ‡∏î src/ ‡πÅ‡∏•‡∏∞ public/ ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö Container
      - ./src:/app/src
      - ./public:/app/public
      
      # 2. ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô node_modules ‡πÉ‡∏ô Container ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ó‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Host
      - /app/node_modules
      
    # üü¢ Environment Variables: ‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ File Sync ‡∏ö‡∏ô Docker 
    environment:
      - PORT=8080
      - CHOKIDAR_USEPOLLING=true 
    
    # üü¢ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Container ‡πÑ‡∏°‡πà‡∏õ‡∏¥‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ô npm start
    stdin_open: true 
    tty: true

  jest-test:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: jest-runner
    command: ["npm", "test", "--", "--watchAll=false"]
    volumes:
      - .:/app
      - /app/node_modules